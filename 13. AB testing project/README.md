# Проект по А/B-тестированию.

<h1>Оглавление:<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><ul class="toc-item"><li><span><a href="#Постановка-задачи." data-toc-modified-id="Постановка-задачи.-0.1"><span class="toc-item-num">0.1&nbsp;&nbsp;</span>Постановка задачи.</a></span></li><li><span><a href="#Техническое-задание:" data-toc-modified-id="Техническое-задание:-0.2"><span class="toc-item-num">0.2&nbsp;&nbsp;</span>Техническое задание:</a></span></li><li><span><a href="#Описание-данных:" data-toc-modified-id="Описание-данных:-0.3"><span class="toc-item-num">0.3&nbsp;&nbsp;</span>Описание данных:</a></span></li></ul></li><li><span><a href="#Шаг-1.-Импортирую-необходимые-библиотеки,-открываю-файлы-с-данными-и-изучаю-общую-информацию." data-toc-modified-id="Шаг-1.-Импортирую-необходимые-библиотеки,-открываю-файлы-с-данными-и-изучаю-общую-информацию.-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Шаг 1. Импортирую необходимые библиотеки, открываю файлы с данными и изучаю общую информацию.</a></span><ul class="toc-item"><li><span><a href="#Вывод:" data-toc-modified-id="Вывод:-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Вывод:</a></span></li></ul></li><li><span><a href="#Шаг-2.-Проверяю-соответствие-ТЗ." data-toc-modified-id="Шаг-2.-Проверяю-соответствие-ТЗ.-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Шаг 2. Проверяю соответствие ТЗ.</a></span><ul class="toc-item"><li><span><a href="#Проверяю-даты-добавления-новых-пользователей." data-toc-modified-id="Проверяю-даты-добавления-новых-пользователей.-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Проверяю даты добавления новых пользователей.</a></span></li><li><span><a href="#Проверяю-даты-событий-новых-пользователей." data-toc-modified-id="Проверяю-даты-событий-новых-пользователей.-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Проверяю даты событий новых пользователей.</a></span></li><li><span><a href="#Проверяю-количество-участников-теста-и-долю-пользователей-из-региона-EU." data-toc-modified-id="Проверяю-количество-участников-теста-и-долю-пользователей-из-региона-EU.-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Проверяю количество участников теста и долю пользователей из региона EU.</a></span></li><li><span><a href="#Проверяю-назначения-теста." data-toc-modified-id="Проверяю-назначения-теста.-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>Проверяю назначения теста.</a></span></li><li><span><a href="#Вывод:" data-toc-modified-id="Вывод:-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span>Вывод:</a></span></li></ul></li><li><span><a href="#Шаг-3.-Проверяю-корректность-проведения-теста." data-toc-modified-id="Шаг-3.-Проверяю-корректность-проведения-теста.-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Шаг 3. Проверяю корректность проведения теста.</a></span><ul class="toc-item"><li><span><a href="#Проверяю-пересечение-теста-с-другими-маркетинговыми-событиями." data-toc-modified-id="Проверяю-пересечение-теста-с-другими-маркетинговыми-событиями.-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Проверяю пересечение теста с другими маркетинговыми событиями.</a></span></li><li><span><a href="#Проверяю-пересечение-тестовой-аудитории-с-конкурирующим-тестом." data-toc-modified-id="Проверяю-пересечение-тестовой-аудитории-с-конкурирующим-тестом.-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>Проверяю пересечение тестовой аудитории с конкурирующим тестом.</a></span></li><li><span><a href="#Сравниваю-количество-пользователей-в-группах." data-toc-modified-id="Сравниваю-количество-пользователей-в-группах.-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span>Сравниваю количество пользователей в группах.</a></span></li><li><span><a href="#Проверяю,-условие,-что-события-происходили-в-течение-14-дней." data-toc-modified-id="Проверяю,-условие,-что-события-происходили-в-течение-14-дней.-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>Проверяю, условие, что события происходили в течение 14 дней.</a></span></li><li><span><a href="#Вывод:" data-toc-modified-id="Вывод:-3.5"><span class="toc-item-num">3.5&nbsp;&nbsp;</span>Вывод:</a></span></li></ul></li><li><span><a href="#Шаг-4.-Провожу-исследовательский-анализ-данных-(EDA)." data-toc-modified-id="Шаг-4.-Провожу-исследовательский-анализ-данных-(EDA).-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Шаг 4. Провожу исследовательский анализ данных (EDA).</a></span><ul class="toc-item"><li><span><a href="#Строю-воронку-событий." data-toc-modified-id="Строю-воронку-событий.-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Строю воронку событий.</a></span></li><li><span><a href="#Строю-воронку-событий-от-общего-количества-участников-групп-А/В-теста." data-toc-modified-id="Строю-воронку-событий-от-общего-количества-участников-групп-А/В-теста.-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Строю воронку событий от общего количества участников групп А/В-теста.</a></span></li><li><span><a href="#Смотрю-распределение-количества-событий." data-toc-modified-id="Смотрю-распределение-количества-событий.-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Смотрю распределение количества событий.</a></span></li><li><span><a href="#Смотрю-распределение-количества-событий-в-группах." data-toc-modified-id="Смотрю-распределение-количества-событий-в-группах.-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>Смотрю распределение количества событий в группах.</a></span></li><li><span><a href="#Смотрю-распределение-количества-событий-по-дням." data-toc-modified-id="Смотрю-распределение-количества-событий-по-дням.-4.5"><span class="toc-item-num">4.5&nbsp;&nbsp;</span>Смотрю распределение количества событий по дням.</a></span></li><li><span><a href="#Смотрю-распределение-количества-событий-по-дням-в-группах." data-toc-modified-id="Смотрю-распределение-количества-событий-по-дням-в-группах.-4.6"><span class="toc-item-num">4.6&nbsp;&nbsp;</span>Смотрю распределение количества событий по дням в группах.</a></span></li><li><span><a href="#Вывод:" data-toc-modified-id="Вывод:-4.7"><span class="toc-item-num">4.7&nbsp;&nbsp;</span>Вывод:</a></span></li></ul></li><li><span><a href="#Шаг-5.-Изучаю-результаты-A/B-теста." data-toc-modified-id="Шаг-5.-Изучаю-результаты-A/B-теста.-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Шаг 5. Изучаю результаты A/B-теста.</a></span><ul class="toc-item"><li><span><a href="#Проверяю-гипотезы-о-равенстве-долей-групп-по-каждому-событию." data-toc-modified-id="Проверяю-гипотезы-о-равенстве-долей-групп-по-каждому-событию.-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>Проверяю гипотезы о равенстве долей групп по каждому событию.</a></span></li><li><span><a href="#Вывод:" data-toc-modified-id="Вывод:-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span>Вывод:</a></span></li></ul></li><li><span><a href="#Общий-вывод:" data-toc-modified-id="Общий-вывод:-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Общий вывод:</a></span><ul class="toc-item"><li><span><a href="#Рекомендации:" data-toc-modified-id="Рекомендации:-6.1"><span class="toc-item-num">6.1&nbsp;&nbsp;</span>Рекомендации:</a></span></li></ul></li></ul></div>

### Постановка задачи.
Задача - провести оценку результатов A/B-теста. В распоряжении есть датасет с действиями пользователей, техническое задание и несколько вспомогательных датасетов.

- Оценить корректность проведения теста.
- Проанализировать результаты теста.

Чтобы оценить корректность проведения теста, проверить:
- пересечение тестовой аудитории с конкурирующим тестом;
- совпадение теста и маркетинговых событий, другие проблемы временных границ теста.

### Техническое задание:
- Название теста: `recommender_system_test`;
- Группы: А (контрольная), B (новая платёжная воронка);
- Дата запуска: 2020-12-07;
- Дата остановки набора новых пользователей: 2020-12-21;
- Дата остановки: 2021-01-04;
- Аудитория: 15% новых пользователей из региона EU;
- Назначение теста: тестирование изменений, связанных с внедрением улучшенной рекомендательной системы;
- Ожидаемое количество участников теста: 6000.
- Ожидаемый эффект: за 14 дней с момента регистрации в системе пользователи покажут улучшение каждой метрики не менее, чем на 10%:
    - конверсии в просмотр карточек товаров - событие `product_page`
    - просмотры корзины - `product_cart`
    - покупки - `purchase`.
    
### Описание данных:
Датасет `ab_project_marketing_events` (календарь маркетинговых событий на 2020 год) содержит:
- **`name`** - название маркетингового события;
- **`regions`** - регионы, в которых будет проводиться рекламная кампания;
- **`start_dt`** - дата начала кампании;
- **`finish_dt`** - дата завершения кампании.

Датасет `final_ab_new_users` (все пользователи, зарегистрировавшиеся в интернет-магазине в период с 7 по 21 декабря 2020 года) содержит:
- **`user_id`** - идентификатор пользователя;
- **`first_date`** - дата регистрации;
- **`region`** - регион пользователя;
- **`device`** - устройство, с которого происходила регистрация.

Датасет `final_ab_events` (все события новых пользователей в период с 7 декабря 2020 по 4 января 2021 года) содержит:
- **`user_id`** - идентификатор пользователя;
- **`event_dt`** - дата и время события;
- **`event_name`** - тип события;
- **`details`** - дополнительные данные о событии. Например, для покупок, purchase, в этом поле хранится стоимость покупки в долларах.

Датасет `final_ab_participants` (таблица участников тестов) содержит:
- **`user_id`** - идентификатор пользователя;
- **`ab_test`** - название теста;
- **`group`** - группа пользователя.
***
## Общий вывод:
В четырех имеющихся датасетах необоснованно пропущенных значений, подлежащих заполнению нет. Типы данных соответствуют содержимому столбцов. Явных дубликатов нет. Данные изначально очень хорошего качества.

После проверки на соответствие ТЗ были выявлены следующие несоответствия:
- Нет событий за 2021 год;
- Присутствуют пользователи участвующие в конкурирующем тесте. 

После проверки на корректность проведения теста были выявлены следующие несоответствия:
- Период проведения A/B-теста пересекается с событием **Christmas&New Year Promo**;
- 25% пользователей recommender_system_test участвовали в конкурирующем тесте;
- Группы имеют существенную разницу в количестве пользователей - **57%** против **43%**;
- При отсечении периода превышающего 14 дней, количество событий уменьшилось на **3462** и отсеклось **2870** пользователей.

В ходе исследовательского анализа данных, была установлена последовательность событий:
- login;
- product_page;
- product_cart;
- purchase - целевое событие.

Все показатели конверсии в группе В дают худший результат, чем в группе А (конверсия в покупку **9%** против **23%**). Группа B также показывает более низкую активность по распределению количества событий на пользователя (в среднем **5.5** против **7**). Можно предположить что на это повлияли:
- Изначальная разница в количестве пользователей;
- Отрыв группы А в первом событии (**72%** против **32%**);
- Внедрение улучшенной рекомендательной системы (дало отрицательный эффект).

Количество событий колеблется примерно на одном уровне до **14** декабря, затем резко возрастает более чем в два раза и постепенно растет до пика **21** декабря, после чего плавно снижается. Вероятно с **14** по **21** декабря большинство клиентов покупают подарки к новому году. Количество событий по группам отображает примерно такую же картину, в группе **А** все практически идентично, а в группе **B** чуть более активный период с **7** по **13** декабря и есть дополнительный пик **16** декабря. Также в обоих группах стали заметны пользователи, покупающие подарки в последний момент. Возможно на такие различия в поведении пользователей в группе **В** повлияло внедрение улучшенной рекомендательной системы. Динамика набора пользователей неактивных по группам очень подозрительная - дополнительное подтверждение некорректности системы работы алгоритма расспределения трафика.

По результатам проведения теста имеются статистически значимые различия в долях тестовой и контрольной групп, отвергаю гипотезу о равенстве долей пользователей на каждом этапе воронки событий. Улучшение каждой метрики не менее, чем на **10%** не наблюдается. Конверсии по каждому из событию меньше в тестовой группе. Средний чек в тестовой группе также меньше. Внедрение улучшенной рекомендательной системы себя не оправдало. Показатели ухудшились.

### Рекомендации:
Необходимо устранить все выявленные несоответствия и повторно провести тест. Если будет получен схожий или худший результат, необходими отказаться от внедрения улучшенной рекомендательной системы, или пересмотреть ее.
